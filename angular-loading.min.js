!function(a,b){"use strict";var c=angular.module("loading",["ngAnimate"]);c.run(["$templateCache",function(a){a.put("loading.tpl.html",'<div class="loading-container"><h4 class="loading-title" ng-bind="title"></h4><div class="loading-body" ng-bind="content"></div></div>')}]),c.provider("$loading",function(){var a=this.defaults={animation:"am-fade",backdropAnimation:"am-fade",prefixClass:"loading",prefixEvent:"loading",template:"loading.tpl.html",contentTemplate:!1,container:!1,element:null,backdrop:!1,html:!1,show:!1,closable:!1};this.$get=["$window","$rootScope","$templateCache","$sce","$compile","$timeout","$q","$http","$animate",function(c,d,e,f,g,h,i,j,k){function l(b){function c(){x.$emit(w.prefixEvent+".show",v)}function e(){x.$emit(w.prefixEvent+".hide",v),i.removeClass(w.prefixClass+"-open"),w.animation&&i.removeClass(w.prefixClass+"-with-"+w.animation)}function h(a){a.target===a.currentTarget&&("static"===w.backdrop?v.focus():v.hide())}var i,j,l,t,u,v={},w=v.$options=angular.extend({},a,b),x=v.$scope=w.scope&&w.scope.$new()||d.$new();return v.$promise=n(w.template),w.element||w.container||(w.container="body"),"body"!==w.container&&(s="-backdrop-inline"),o(["title","content"],function(a){w[a]&&(x[a]=f.trustAsHtml(w[a]))}),i=angular.isElement(w.container)?w.container:w.container?m(w.container):null,j=w.container?null:w.element,x.$hide=function(){x.$$postDigest(function(){v.hide()})},x.$show=function(){x.$$postDigest(function(){v.show()})},x.$toggle=function(){x.$$postDigest(function(){v.toggle()})},x.$update=function(a){x.$$postDigest(function(){v.update(a)})},w.contentTemplate&&(v.$promise=v.$promise.then(function(a){var b=angular.element(a);return n(w.contentTemplate).then(function(a){m('[ng-bind="content"]',b[0]).removeAttr("ng-bind").html(a);return b[0].outerHTML})})),u=angular.element('<div class="'+w.prefixClass+s+'"/>'),v.$promise.then(function(a){angular.isObject(a)&&(a=a.data),w.html&&(a=a.replace(r,'ng-bind-html="')),a=p.apply(a),l=g(a),v.init()}),v.init=function(){w.show&&x.$$postDigest(function(){v.show()})},v.destroy=function(){t&&(t.remove(),t=null),u&&(u.remove(),u=null),x.$destroy()},v.show=function(){if(!x.$isShown&&!x.$emit(w.prefixEvent+".show.before",v).defaultPrevented){t=v.$element=l(x,function(){}),t.css({display:"block"}),w.animation&&(w.backdrop&&u.addClass(w.backdropAnimation),t.addClass(w.animation)),w.backdrop&&k.enter(u,i,null);var a=k.enter(t,i,j,c);a&&a.then&&a.then(c),x.$isShown=!0,x.$$phase||x.$root&&x.$root.$$phase||x.$digest();var b=t[0];q(function(){b.focus()}),i.addClass(w.prefixClass+"-open"),w.animation&&i.addClass(w.prefixClass+"-with-"+w.animation),w.backdrop&&w.closable&&(t.on("click",h),u.on("click",h))}},v.hide=function(){if(x.$isShown&&!x.$emit(w.prefixEvent+".hide.before",v).defaultPrevented){var a=k.leave(t,e);a&&a.then&&a.then(e),w.backdrop&&k.leave(u),x.$isShown=!1,x.$$phase||x.$root&&x.$root.$$phase||x.$digest(),w.backdrop&&w.closable&&(t.off("click",h),u.off("click",h))}},v.toggle=function(){x.$isShown?v.hide():v.show()},v.focus=function(){t[0].focus()},v.update=function(a){t&&(w=v.$options=angular.extend({},w,a),o(["title","content"],function(a){w[a]&&(x[a]=f.trustAsHtml(w[a]))}))},v}function m(a,c){return angular.element((c||b).querySelectorAll(a))}function n(a){return i.when(e.get(a)||j.get(a)).then(function(b){return angular.isObject(b)?(e.put(a,b.data),b.data):b})}var o=angular.forEach,p=String.prototype.trim,q=c.requestAnimationFrame||c.setTimeout,r=/ng-bind="/gi,s="-backdrop";return l}]}),c.directive("loading",["$window","$sce","$loading",function(a,b,c){return{restrict:"EAC",scope:!0,link:function(a,d,e){var f={scope:a,element:d,show:!1};angular.forEach(["template","container","backdrop","html"],function(a){angular.isDefined(e[a])&&(f[a]=e[a])}),angular.forEach(["title","content"],function(c){e[c]&&e.$observe(c,function(d){a[c]=b.trustAsHtml(d)})}),e.loading&&a.$watch(e.loading,function(b){angular.isObject(b)?angular.extend(a,b):a.content=b},!0);var g=c(f);d.on(e.trigger||"click",g.toggle),a.$on("$destroy",function(){g&&g.destroy(),f=null,g=null})}}}])}(window,document);